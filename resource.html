<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <title>TJHSST LIFT</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Noto+Sans:700|Nunito|PT+Sans:700" rel="stylesheet">
        <script src="JS/jquery-3.2.1.min.js"></script>
        <link rel="stylesheet" href="CSS/resource.css">
    </head>
    <body>
        <div class="navigation">
            <a href="about.html">About</a>
            <a href="signup.html">Sign Up</a>
            <a class="active" href="resource.html">Resources</a>
            <a href="curriculum.html">Curriculum</a>
            <a href="index.html">Home</a>
            <a href="index.html" class="logo"></a>
        </div>
       <div class="banner">
            <div class="title">
                <p id="title-p">Resources</p>
            </div>
        </div>
        <div class="main">
            <div class="current" align="left">
                <p class="c-title">Forms</p>
            </div>
            <div class="old">
            </div>
            <div class="drop-info">
                <p class="close" align="left">x</p>
                <p class="d-title" align="center">Title</p>
            </div>
        </div>
    </body>
</html>

<script type="text/javascript" src="JSON/forms.json"></script>
<script>

$(window).on("load", function() {
    $(".active").css("color","rgb(200, 200, 255)")
    $(".drop-info").hide()

    $(window).scroll(function(){
        var pos = $(document).scrollTop();
        if(pos>=240){
            $(".navigation").css("background-color", "white")
            $(".navigation a").css("color", "black")
            $(".logo").css("background-image","url('Pics/tjlogo2.png')")
        }
        else{
            $(".navigation").css("background-color", "transparent")
            $(".navigation a").css("color", "white")
            $(".logo").css("background-image","url('Pics/tjlogo2-light.png')")
        }
    });

    $(".t-block").click(function(){
        $(".t-block").css("filter", "brightness(100%)")
        $(this).css("filter", "brightness(40%)").fadeIn()
        var image = $(this).children(".thumbnail").css("background-image").replace("(", "").replace(")", "")
        image = image.substring(image.lastIndexOf("Pics"), image.length-1)
        console.log(image)
        var title = $(this).text()
        var sub  = $(this).parent().parent().parent().parent().parent().parent().attr("class")
        var drop = "#drop-" + sub
        $(drop+" .d-title").text(title)
        $(drop).children(".slides").children("#s-img").attr("src", image)
        $(drop).slideDown()
    })

    $(".close").click(function(){
        $(this).parent().slideUp()
        $(".t-block").css("filter", "brightness(100%)")
    })

    var d = JSON.parse(forms)
    console.log(d[0])

    $.getJSON("JSON/forms.json", function(data){ //load current forms
        var years = []
        for(i=0;i<data.length;i++)
        {
            var name= data[i]["name"]
            var date= data[i]["date"]
            var path= data[i]["file"]
            var year= data[i]["year"]
            var fname = name + path.split(".")[1]
            var current= parseInt(data[i]["current"])

            if(current==1)
            {
                if(!years.includes(year))
                {
                    var di = "di"+year
                    years.push(year)
                    $(".old").append(
                        "<div class='year'>"+ year +"</div>"
                    )
                    $(".drop-info").append(
                        "<div class='"+di+"'></div>"
                    )

                }
                $(".current").append(
                    '<div class="sheet" align="center"><p class="s-title">' + name + '</p><div class="s-container" align="center" style="background-color: rgb(57, 146, 230);"><a class="s-click" href="'+path+'" target="_blank">Preview</a><a class="s-click" href="Pics/tjpdf.pdf" download="'+ fname +'">Download</a></div></div>'
                )
            }
            else
            {
                var di = "di"+year
                if(!years.includes(year))
                {
                    years.push(year)
                    $(".old").append(
                        "<div class='year'>"+ year +"</div>"
                    )
                    $(".drop-info").append(
                        "<div class='"+di+"'></div>"
                    )
                }
            }
        }
    })
})

$(".year").click(function(){ //click a year
        var tyear = parseInt($(this).text())
        console.log("a")

        $.getJSON("JSON/forms.json", function(data){
        var years = []
        for(i=0;i<data.length;i++)
        {
            var name= data[i]["name"]
            var date= data[i]["date"]
            var path= data[i]["file"]
            var year= data[i]["year"]
            var fname = name + path.split(".")[1]
            var current= parseInt(data[i]["current"])

            if(current!=1)
            {
                console.log(data[i])
                var di = "di"+year
                if(!years.includes(year))
                {
                    years.push(year)
                    $(".old").append(
                        "<div class='year'>"+ year +"</div>"
                    )
                    $(".drop-info").append(
                        "<div class='"+di+"'></div>"
                    )
                    if(!tyear==year)
                        $("di"+year).hide()
                }
                $("."+di).append(`
                    <div class="o-sheet">
                        <div class="date">`+date+`</div>
                        <div class="o-form">`+name+`</div>
                        <div class="o-container" align="center" style="background-color: rgb(57, 146, 230);">
                            <a class="o-click" href="`+path+`" target="_blank">Preview</a>
                            <a class="o-click" href="`+path+`" download="`+fname+`">Download</a>
                        </div>
                    </div>
                `)
            }
        }
        })

        $(".drop-info").show()
    })

</script>